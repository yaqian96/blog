---
title: 下载文件
date: 2020-05-14 
permalink: 
categories: 
  - 工具函数
tags: 
  - null
---
```js
/**
 * 保存Excel文件
 * @param {object} params0
 */
export function saveExcel ({ content, filename }) {
  // const blob = new Blob([content], {
  //   type: 'application/ms-excel'
  // })
  const blob = new Blob([content], {
    type: 'application/vnd.ms-excel'
  })
  const fileName = `${filename}.xls`
  if ('download' in document.createElement('a')) {
    // 非IE下载
    let elink = document.createElement('a')
    elink.download = fileName
    elink.style.display = 'none'
    elink.href = URL.createObjectURL(blob)
    document.body.appendChild(elink)
    elink.click()
    URL.revokeObjectURL(elink.href) // 释放URL 对象
    document.body.removeChild(elink)
    return 200
  } else {
    // IE10+下载
    navigator.msSaveBlob(blob, fileName)
    return 200
  }
}

/**
 * 保存Pdf文件
 * @param {object} params0
 */
export function savePdf ({ content, filename }) {
  // const blob = new Blob([content], {
  //   type: 'application/ms-excel'
  // })
  const blob = new Blob([content], {
    type: 'application/vnd.ms-excel'
  })
  const fileName = `${filename}.pdf`
  if ('download' in document.createElement('a')) {
    // 非IE下载
    let elink = document.createElement('a')
    elink.download = fileName
    elink.style.display = 'none'
    elink.href = URL.createObjectURL(blob)
    document.body.appendChild(elink)
    elink.click()
    URL.revokeObjectURL(elink.href) // 释放URL 对象
    document.body.removeChild(elink)
    return 200
  } else {
    // IE10+下载
    navigator.msSaveBlob(blob, fileName)
    return 200
  }
}
```