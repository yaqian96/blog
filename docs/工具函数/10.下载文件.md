---
title: 下载文件
date: 2020-05-14 
permalink: 
categories: 
  - 工具函数
tags: 
  - null
---
```js
/**
 * 保存Excel文件
 * @param {object} params0
 */
export function saveExcel ({ content, filename }) {
  // const blob = new Blob([content], {
  //   type: 'application/ms-excel'
  // })
  const blob = new Blob([content], {
    type: 'application/vnd.ms-excel'
  })
  const fileName = `${filename}.xls`
  if ('download' in document.createElement('a')) {
    // 非IE下载
    let elink = document.createElement('a')
    elink.download = fileName
    elink.style.display = 'none'
    elink.href = URL.createObjectURL(blob)
    document.body.appendChild(elink)
    elink.click()
    URL.revokeObjectURL(elink.href) // 释放URL 对象
    document.body.removeChild(elink)
    return 200
  } else {
    // IE10+下载
    navigator.msSaveBlob(blob, fileName)
    return 200
  }
}

/**
 * 保存Pdf文件
 * @param {object} params0
 */
export function savePdf ({ content, filename }) {
  // const blob = new Blob([content], {
  //   type: 'application/ms-excel'
  // })
  const blob = new Blob([content], {
    type: 'application/vnd.ms-excel'
  })
  const fileName = `${filename}.pdf`
  if ('download' in document.createElement('a')) {
    // 非IE下载
    let elink = document.createElement('a')
    elink.download = fileName
    elink.style.display = 'none'
    elink.href = URL.createObjectURL(blob)
    document.body.appendChild(elink)
    elink.click()
    URL.revokeObjectURL(elink.href) // 释放URL 对象
    document.body.removeChild(elink)
    return 200
  } else {
    // IE10+下载
    navigator.msSaveBlob(blob, fileName)
    return 200
  }
}
```
```js
// 知道file文件的url转换成blob对象并上传，formData
    // 将url转换成dataURL
    convertFileToDataURLviaFileReader (url, callback) {
      const xhr = new XMLHttpRequest()
      xhr.responseType = 'blob'
      xhr.onload = function() {
        const reader = new FileReader()
        reader.onloadend = function() {
          callback(reader.result)
        }
        reader.readAsDataURL(xhr.response)
      }
      xhr.open('GET', url)
      xhr.send()
    },
    // 将DataUrl转换成Blob对象
    dataURLToBlob (dataurl) {
      let arr = dataurl.split(',');
      let mime = arr[0].match(/:(.*?);/)[1];
      let bstr = atob(arr[1]);
      let n = bstr.length;
      let u8arr = new Uint8Array(n);
      while (n--) {
        u8arr[n] = bstr.charCodeAt(n)
      }
      return new Blob([u8arr], { type: mime })
    },
    // 将Blob对象转换成formData
    let fd = new FormData();
    fd.append('file', blob);
    fd.append('fiscalYear', this.filterData.year);
    fd.append('term', this.filterData.quarter,)
```
```js
使用该POST方法并将enctype属性设置为 application/x-www-form-urlencoded（默认）；
使用该POST方法并将enctype属性设置为 text/plain;
使用该POST方法并将enctype属性设置为 multipart/form-data;
使用GET方法（在这种情况下，该enctype属性将被忽略）。
```